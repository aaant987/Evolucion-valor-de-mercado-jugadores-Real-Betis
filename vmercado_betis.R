
library(tidyverse)
library(datapasta)
library(ggrepel)
library(extrafont)
windowsFonts("Bahnschrift" = windowsFont("Bahnschrift"))
library(ragg)


df <- tibble::tribble(
             ~jugador,                 ~equipos, ~temporada, ~edad,  ~valor,  ~pts, ~elo,
          "Rui Silva",             "Real Betis",  "2021/22",    NA, "11 M.",  76.4,  76L,
          "Rui Silva",                "Granada",  "2020/21",    NA,  "8 M.",  81.8,  79L,
          "Rui Silva",                "Granada",  "2019/20",    NA,  "4 M.",  68.7,  75L,
          "Rui Silva",                "Granada",  "2018/19",    NA,  "1 M.",  44.5,  68L,
          "Rui Silva",                "Granada",  "2017/18",    NA,  "2 M.",  34.2,  54L,
          "Rui Silva",               "Nacional",  "2016/17",    NA,  "2 M.",  31.4,  61L,
          "Rui Silva",               "Nacional",  "2015/16",    NA,  "1 M.",    39,  54L,
          "Rui Silva",               "Nacional",  "2014/15",    NA,     "0",  41.2,  44L,
          "Rui Silva",               "Nacional",  "2013/14",    NA,     "0",  46.2,  33L,
              "Bravo",             "Real Betis",  "2021/22",    NA,     "0",  50.7,  75L,
              "Bravo",             "Real Betis",  "2020/21",    NA,     "0",  56.9,  73L,
              "Bravo",              "Man. City",  "2019/20",    NA,  "1 M.", 106.4,  67L,
              "Bravo",              "Man. City",  "2018/19",    NA,  "2 M.", 115.3,  69L,
              "Bravo",              "Man. City",  "2017/18",    NA, "10 M.", 197.1,  79L,
              "Bravo",              "Man. City",  "2016/17",    NA, "10 M.",  80.1,  85L,
              "Bravo",              "Barcelona",  "2015/16",    NA, "16 M.", 101.3,  83L,
              "Bravo",              "Barcelona",  "2014/15",    NA, "23 M.",  33.9,  84L,
              "Bravo",            "R. Sociedad",  "2013/14",    NA, "17 M.",  61.2,  84L,
              "Bravo",            "R. Sociedad",  "2012/13",    NA, "17 M.",  34.9,  83L,
              "Bravo",            "R. Sociedad",  "2011/12",    NA, "11 M.",  27.4,  80L,
              "Bravo",            "R. Sociedad",  "2010/11",    NA,  "6 M.",  24.6,  75L,
              "Bravo",            "R. Sociedad",  "2009/10",    NA,  "2 M.",  18.9,  68L,
              "Bravo",            "R. Sociedad",  "2008/09",    NA,  "1 M.",  18.8,  66L,
              "Bravo",            "R. Sociedad",  "2006/07",    NA,  "1 M.",  27.3,  63L,
              "Bravo",              "Colo-Colo",  "2005/06",    NA,     "0",   7.8,  40L,
              "Bravo",              "Colo-Colo",  "2004/05",    NA,     "0",    26,  41L,
              "Bravo",              "Colo-Colo",  "2003/04",    NA,     "0",  19.3,  39L,
              "Bravo",              "Colo-Colo",  "2002/03",    NA,     "0",  11.6,  25L,
               "Joel",             "Real Betis",  "2021/22",    NA,  "5 M.",  15.2,  69L,
               "Joel",             "Real Betis",  "2020/21",    NA,  "5 M.",  63.6,  75L,
               "Joel",             "Real Betis",  "2019/20",    NA,  "3 M.",  58.3,  73L,
               "Joel",             "Real Betis",  "2018/19",    NA,  "2 M.",  88.9,  62L,
               "Joel",                "Everton",  "2017/18",    NA,  "1 M.",  16.9,  61L,
               "Joel",                "Everton",  "2016/17",    NA,  "1 M.",  48.6,  69L,
               "Joel",                "Everton",  "2015/16",    NA,  "1 M.",  79.7,  66L,
               "Joel",                "Everton",  "2014/15",    NA,  "1 M.",  88.7,  57L,
               "Joel",                "Everton",  "2013/14",    NA,  "2 M.",  44.1,  58L,
               "Joel",         "Wigan Athletic",  "2012/13",    NA,  "1 M.",  67.1,  62L,
               "Joel",         "Rayo Vallecano",  "2011/12",    NA,     "0",  24.8,  54L,
               "Joel",               "Atlético",  "2010/11",    NA,     "0",  46.9,  42L,
               "Joel",               "Atlético",  "2009/10",    NA,     "0",    12,  47L,
           "Pezzella",             "Real Betis",  "2021/22",    NA, "11 M.",  52.9,  78L,
           "Pezzella",             "Fiorentina",  "2020/21",    NA, "16 M.",  71.8,  80L,
           "Pezzella",             "Fiorentina",  "2019/20",    NA, "21 M.",    50,  82L,
           "Pezzella",             "Fiorentina",  "2018/19",    NA, "12 M.",  92.2,  83L,
           "Pezzella",             "Fiorentina",  "2017/18",    NA,  "6 M.",  56.3,  79L,
           "Pezzella",             "Real Betis",  "2016/17",    NA,  "6 M.",  33.3,  74L,
           "Pezzella",             "Real Betis",  "2015/16",    NA,  "6 M.",  44.5,  72L,
           "Pezzella",            "River Plate",  "2014/15",    NA,  "4 M.", 114.5,  70L,
           "Pezzella",            "River Plate",  "2013/14",    NA,  "3 M.", 137.7,  68L,
           "Pezzella",            "River Plate",  "2012/13",    NA,  "1 M.",  51.3,  57L,
           "Pezzella",            "River Plate",  "2011/12",    NA,     "0",  52.6,  48L,
             "Bartra",             "Real Betis",  "2021/22",    NA, "13 M.",  57.1,  78L,
             "Bartra",             "Real Betis",  "2020/21",    NA, "16 M.",  53.9,  82L,
             "Bartra",             "Real Betis",  "2019/20",    NA, "18 M.",  53.6,  84L,
             "Bartra",             "Real Betis",  "2018/19",    NA, "19 M.",  98.5,  84L,
             "Bartra",             "Real Betis",  "2017/18",    NA,  "2 M.",    34,  82L,
             "Bartra",            "B. Dortmund",  "2016/17",    NA,  "6 M.", 138.4,  73L,
             "Bartra",              "Barcelona",  "2015/16",    NA,  "8 M.",  74.3,  66L,
             "Bartra",              "Barcelona",  "2014/15",    NA,  "7 M.",  92.7,  70L,
             "Bartra",              "Barcelona",  "2013/14",    NA,  "4 M.",    87,  69L,
             "Bartra",              "Barcelona",  "2012/13",    NA,  "3 M.",  48.7,  59L,
             "Bartra",              "Barcelona",  "2011/12",    NA,  "1 M.",    27,  63L,
             "Bartra",            "Barcelona B",  "2011/12",    NA,  "1 M.",  17.4,  65L,
             "Bartra",              "Barcelona",  "2010/11",    NA,     "0",  85.5,  62L,
             "Bartra",            "Barcelona B",  "2010/11",    NA,     "0",  17.6,  63L,
             "Bartra",            "Barcelona B",  "2009/10",    NA,     "0",  25.4,  48L,
             "V.Ruiz",             "Real Betis",  "2021/22",    NA,  "5 M.",  68.7,  75L,
             "V.Ruiz",             "Real Betis",  "2020/21",    NA,  "7 M.",  48.4,  75L,
             "V.Ruiz",               "Besiktas",  "2019/20",    NA, "10 M.",  41.5,  74L,
             "V.Ruiz",             "Villarreal",  "2019/20",    NA, "13 M.",  12.7,  75L,
             "V.Ruiz",             "Villarreal",  "2018/19",    NA, "14 M.", 107.6,  80L,
             "V.Ruiz",             "Villarreal",  "2017/18",    NA, "17 M.",  79.5,  81L,
             "V.Ruiz",             "Villarreal",  "2016/17",    NA, "19 M.",  85.4,  84L,
             "V.Ruiz",             "Villarreal",  "2015/16",    NA, "13 M.",  68.4,  83L,
             "V.Ruiz",             "Villarreal",  "2014/15",    NA,  "7 M.", 118.6,  74L,
             "V.Ruiz",               "Valencia",  "2013/14",    NA, "11 M.",  51.4,  69L,
             "V.Ruiz",               "Valencia",  "2012/13",    NA, "12 M.",  78.7,  73L,
             "V.Ruiz",               "Valencia",  "2011/12",    NA,  "5 M.", 117.7,  75L,
             "V.Ruiz",                 "Napoli",  "2010/11",    NA,  "1 M.",  41.2,  65L,
             "V.Ruiz",               "Espanyol",  "2010/11",    NA,  "2 M.",  51.5,  66L,
             "V.Ruiz",             "Espanyol B",  "2009/10",    NA,     "0",  13.9,  61L,
           "Bellerín",             "Real Betis",  "2021/22",    NA,  "8 M.",  31.4,  73L,
           "Bellerín",                "Arsenal",  "2021/22",    NA, "15 M.",   8.6,  74L,
           "Bellerín",                "Arsenal",  "2020/21",    NA, "14 M.",  86.7,  77L,
           "Bellerín",                "Arsenal",  "2019/20",    NA,  "8 M.", 138.4,  75L,
           "Bellerín",                "Arsenal",  "2018/19",    NA, "38 M.",    90,  83L,
           "Bellerín",                "Arsenal",  "2017/18",    NA, "31 M.",  82.2,  83L,
           "Bellerín",                "Arsenal",  "2016/17",    NA, "28 M.", 118.5,  81L,
           "Bellerín",                "Arsenal",  "2015/16",    NA, "16 M.",  84.6,  81L,
           "Bellerín",                "Arsenal",  "2014/15",    NA,  "1 M.", 202.8,  69L,
             "Sabaly",             "Real Betis",  "2021/22",    NA,  "8 M.",  17.6,  72L,
             "Sabaly",     "Girondins Bordeaux",  "2020/21",    NA,  "9 M.",  24.6,  74L,
             "Sabaly",     "Girondins Bordeaux",  "2019/20",    NA, "13 M.",  37.5,  74L,
             "Sabaly",     "Girondins Bordeaux",  "2018/19",    NA, "15 M.",  84.3,  77L,
             "Sabaly",     "Girondins Bordeaux",  "2017/18",    NA, "11 M.",  81.3,  78L,
             "Sabaly",     "Girondins Bordeaux",  "2016/17",    NA, "10 M.",  44.3,  74L,
             "Sabaly",                 "Nantes",  "2015/16",    NA,  "6 M.",  59.8,  73L,
             "Sabaly",  "Evian Thonon Gaillard",  "2014/15",    NA,  "5 M.",  52.5,  71L,
             "Sabaly",  "Evian Thonon Gaillard",  "2013/14",    NA,  "1 M.",  41.3,  68L,
          "A. Moreno",             "Real Betis",  "2021/22",    NA,  "6 M.",  75.9,  71L,
          "A. Moreno",             "Real Betis",  "2020/21",    NA,  "6 M.",  70.5,  72L,
          "A. Moreno",             "Real Betis",  "2019/20",    NA,  "4 M.",  44.9,  74L,
          "A. Moreno",         "Rayo Vallecano",  "2018/19",    NA,  "4 M.",  35.6,  72L,
          "A. Moreno",         "Rayo Vallecano",  "2017/18",    NA,  "2 M.",  33.1,  70L,
          "A. Moreno",         "Rayo Vallecano",  "2016/17",    NA,  "1 M.",  31.6,  63L,
          "A. Moreno",                  "Elche",  "2015/16",    NA,  "1 M.",  36.4,  62L,
          "A. Moreno",         "Rayo Vallecano",  "2014/15",    NA,  "1 M.",  49.8,  55L,
          "A. Moreno",             "Mallorca B",  "2013/14",    NA,     "0",   7.2,  50L,
          "A. Moreno",         "UE Costa Brava",  "2012/13",    NA,     "0",  12.4,  40L,
          "A. Moreno",       "Barcelona Sub 19",  "2011/12",    NA,     "0",   1.1,  25L,
            "Miranda",             "Real Betis",  "2021/22",    NA,  "7 M.",  69.7,  68L,
            "Miranda",             "Real Betis",  "2020/21",    NA,  "3 M.",  49.6,  69L,
            "Miranda",             "Schalke 04",  "2019/20",    NA,  "1 M.",  21.4,  58L,
            "Miranda",       "Barcelona Sub 19",  "2018/19",    NA,     "0",   9.4,  57L,
              "Edgar",             "Real Betis",  "2021/22",    NA,  "2 M.",  70.1,  68L,
              "Edgar",            "Real Oviedo",  "2020/21",    NA,  "1 M.",  40.4,  65L,
              "Edgar",        "Betis Deportivo",  "2019/20",    NA,     "0",  21.1,  56L,
              "Edgar",        "Betis Deportivo",  "2018/19",    NA,     "0",  11.8,  56L,
              "Edgar",               "Cornellà",  "2017/18",    NA,     "0",  34.3,  50L,
              "Edgar",               "Cornellà",  "2016/17",    NA,     "0",   8.3,  38L,
            "Montoya",             "Real Betis",  "2021/22",    NA,  "3 M.",  68.4,  61L,
            "Montoya",             "Real Betis",  "2020/21",    NA,  "5 M.",  51.5,  64L,
            "Montoya", "Brighton & Hove Albion",  "2019/20",    NA,  "6 M.",  46.5,  72L,
            "Montoya", "Brighton & Hove Albion",  "2018/19",    NA,  "5 M.",  35.3,  71L,
            "Montoya",               "Valencia",  "2017/18",    NA,  "6 M.",  74.8,  74L,
            "Montoya",               "Valencia",  "2016/17",    NA,  "3 M.",  41.8,  67L,
            "Montoya",             "Real Betis",  "2015/16",    NA,  "1 M.",  22.7,  62L,
            "Montoya",              "Barcelona",  "2014/15",    NA,  "5 M.",   107,  62L,
            "Montoya",              "Barcelona",  "2013/14",    NA,  "6 M.",  68.1,  67L,
            "Montoya",              "Barcelona",  "2012/13",    NA,  "5 M.",  69.9,  64L,
            "Montoya",              "Barcelona",  "2011/12",    NA,  "1 M.",  83.1,  64L,
            "Montoya",              "Barcelona",  "2010/11",    NA,     "0",  11.4,  58L,
            "Montoya",            "Barcelona B",  "2010/11",    NA,     "0",  16.8,  59L,
            "Montoya",            "Barcelona B",  "2009/10",    NA,     "0",  24.9,  46L,
            "Montoya",            "Barcelona B",  "2008/09",    NA,     "0",     5,  31L,
            "Canales",             "Real Betis",  "2021/22",    NA, "22 M.",  85.3,  84L,
            "Canales",             "Real Betis",  "2020/21",    NA, "19 M.",    93,  86L,
            "Canales",             "Real Betis",  "2019/20",    NA, "17 M.",  56.6,  85L,
            "Canales",             "Real Betis",  "2018/19",    NA,  "9 M.", 129.4,  85L,
            "Canales",            "R. Sociedad",  "2017/18",    NA,  "4 M.",  79.2,  72L,
            "Canales",            "R. Sociedad",  "2016/17",    NA,  "5 M.",    36,  63L,
            "Canales",            "R. Sociedad",  "2015/16",    NA,  "7 M.",  44.7,  72L,
            "Canales",            "R. Sociedad",  "2014/15",    NA,  "6 M.",  39.8,  74L,
            "Canales",            "R. Sociedad",  "2013/14",    NA,  "2 M.",  26.6,  68L,
            "Canales",               "Valencia",  "2012/13",    NA,  "4 M.",  31.1,  60L,
            "Canales",               "Valencia",  "2011/12",    NA,  "4 M.",  41.8,  62L,
            "Canales",            "Real Madrid",  "2010/11",    NA,  "3 M.",    32,  65L,
            "Canales",                 "Racing",  "2009/10",    NA,     "0",    55,  68L,
              "Fekir",             "Real Betis",  "2021/22",    NA, "17 M.", 105.4,  83L,
              "Fekir",             "Real Betis",  "2020/21",    NA, "21 M.",  42.1,  81L,
              "Fekir",             "Real Betis",  "2019/20",    NA, "28 M.",  66.2,  84L,
              "Fekir",     "Olympique Lyonnais",  "2018/19",    NA, "31 M.", 112.9,  86L,
              "Fekir",     "Olympique Lyonnais",  "2017/18",    NA, "19 M.", 195.9,  87L,
              "Fekir",     "Olympique Lyonnais",  "2016/17",    NA,  "6 M.",   149,  78L,
              "Fekir",      "Olympique Lyon II",  "2015/16",    NA,  "1 M.",   2.6,  68L,
              "Fekir",     "Olympique Lyonnais",  "2015/16",    NA,  "4 M.",  29.1,  74L,
              "Fekir",     "Olympique Lyonnais",  "2014/15",    NA,  "2 M.", 102.8,  75L,
              "Fekir",     "Olympique Lyonnais",  "2013/14",    NA,     "0",    19,  48L,
              "Fekir",      "Olympique Lyon II",  "2012/13",    NA,     "0",   3.8,  37L,
              "Fekir",      "Olympique Lyon II",  "2011/12",    NA,     "0",   3.4,  33L,
              "Guido",             "Real Betis",  "2021/22",    NA, "17 M.",  37.4,  80L,
              "Guido",             "Real Betis",  "2020/21",    NA, "14 M.",  56.5,  80L,
              "Guido",             "Real Betis",  "2019/20",    NA,  "8 M.",    35,  80L,
              "Guido",                "América",  "2018/19",    NA, "15 M.", 236.1,  83L,
              "Guido",                "América",  "2017/18",    NA,  "8 M.", 153.7,  75L,
              "Guido",                "Tijuana",  "2016/17",    NA,  "3 M.",  99.5,  70L,
              "Guido",     "Defensa y Justicia",  "2015/16",    NA,  "1 M.",    36,  57L,
              "Guido",            "River Plate",  "2014/15",    NA,     "0",  35.5,  47L,
              "Guido",            "River Plate",  "2013/14",    NA,     "0",  46.5,  42L,
           "Guardado",             "Real Betis",  "2021/22",    NA,  "4 M.",  58.1,  72L,
           "Guardado",             "Real Betis",  "2020/21",    NA,  "7 M.",  38.4,  74L,
           "Guardado",             "Real Betis",  "2019/20",    NA, "11 M.",  38.7,  79L,
           "Guardado",             "Real Betis",  "2018/19",    NA, "14 M.",    86,  79L,
           "Guardado",             "Real Betis",  "2017/18",    NA, "18 M.",  36.1,  78L,
           "Guardado",                    "PSV",  "2016/17",    NA, "29 M.", 108.4,  81L,
           "Guardado",                    "PSV",  "2015/16",    NA, "23 M.",  88.7,  83L,
           "Guardado",                    "PSV",  "2014/15",    NA, "14 M.",  54.3,  78L,
           "Guardado",               "Valencia",  "2013/14",    NA, "22 M.", 120.5,  78L,
           "Guardado",               "Valencia",  "2012/13",    NA, "13 M.",  63.2,  80L,
           "Guardado",              "Deportivo",  "2011/12",    NA,  "8 M.",  25.1,  75L,
           "Guardado",              "Deportivo",  "2010/11",    NA, "15 M.",  23.2,  73L,
           "Guardado",              "Deportivo",  "2009/10",    NA, "16 M.", 124.4,  79L,
           "Guardado",              "Deportivo",  "2008/09",    NA,  "7 M.",  70.2,  76L,
           "Guardado",              "Deportivo",  "2007/08",    NA,  "3 M.",  24.8,  70L,
           "Guardado",      "Atlas Guadalajara",  "2006/07",    NA,  "1 M.",  40.6,  59L,
           "Guardado",      "Atlas Guadalajara",  "2005/06",    NA,     "0",  25.1,  50L,
        "W. Carvalho",             "Real Betis",  "2021/22",    NA, "20 M.",  32.5,  68L,
        "W. Carvalho",             "Real Betis",  "2020/21",    NA, "22 M.",  28.3,  74L,
        "W. Carvalho",             "Real Betis",  "2019/20",    NA, "46 M.",  24.1,  83L,
        "W. Carvalho",             "Real Betis",  "2018/19",    NA, "36 M.",  99.4,  83L,
        "W. Carvalho",            "Sporting CP",  "2017/18",    NA, "26 M.", 109.3,  79L,
        "W. Carvalho",            "Sporting CP",  "2016/17",    NA, "25 M.",  63.7,  80L,
        "W. Carvalho",            "Sporting CP",  "2015/16",    NA, "16 M.",  85.6,  81L,
        "W. Carvalho",            "Sporting CP",  "2014/15",    NA, "12 M.", 103.1,  77L,
        "W. Carvalho",            "Sporting CP",  "2013/14",    NA,  "2 M.",    72,  74L,
        "W. Carvalho",          "Cercle Brugge",  "2012/13",    NA,  "1 M.",  28.6,  56L,
        "W. Carvalho",          "Cercle Brugge",  "2011/12",    NA,     "0",  31.5,  55L,
        "W. Carvalho",            "Sporting CP",  "2010/11",    NA,     "0",   0.3,  32L,
              "Rodri",             "Real Betis",  "2021/22",    NA,  "1 M.",  92.5,  62L,
              "Rodri",             "Real Betis",  "2020/21",    NA,     "0",  25.8,  53L,
              "Rodri",        "Betis Deportivo",  "2019/20",    NA,     "0",  27.3,  49L,
              "Rodri",             "Real Betis",  "2018/19",    NA,     "0",  11.2,  42L,
              "Rodri",        "Betis Deportivo",  "2018/19",    NA,     "0",  10.9,  43L,
           "Camarasa",             "Real Betis",  "2021/22",    NA,  "3 M.",  15.4,  56L,
           "Camarasa",                 "Alavés",  "2019/20",    NA,  "1 M.",  20.2,  64L,
           "Camarasa",         "Crystal Palace",  "2019/20",    NA,  "4 M.",  14.4,  66L,
           "Camarasa",             "Real Betis",  "2019/20",    NA,  "5 M.",  15.3,  68L,
           "Camarasa",           "Cardiff City",  "2018/19",    NA,  "5 M.",  26.2,  69L,
           "Camarasa",             "Real Betis",  "2017/18",    NA,  "7 M.",  34.1,  72L,
           "Camarasa",                 "Alavés",  "2016/17",    NA,  "5 M.",  47.2,  72L,
           "Camarasa",                "Levante",  "2015/16",    NA,  "2 M.",    16,  63L,
           "Camarasa",                "Levante",  "2014/15",    NA,  "1 M.",  33.7,  57L,
           "Camarasa",                "Levante",  "2013/14",    NA,     "0",  26.3,  44L,
           "Camarasa",            "At. Levante",  "2012/13",    NA,     "0",   0.3,  25L,
               "Paul",             "Real Betis",  "2021/22",    NA,  "1 M.",  68.8,  49L,
               "Paul",             "Real Betis",  "2020/21",    NA,     "0",  37.2,  50L,
               "Paul",        "Betis Deportivo",  "2019/20",    NA,     "0",    22,  46L,
               "Paul",        "Betis Deportivo",  "2018/19",    NA,     "0",   6.1,  40L,
               "Paul",   "Hapoel Rishon Lezion",  "2017/18",    NA,     "0",   6.1,  41L,
               "Paul",              "Ekenäs IF",  "2016/17",    NA,     "0",  17.7,  31L,
        "B. Iglesias",             "Real Betis",  "2021/22",    NA,  "7 M.",  78.1,  75L,
        "B. Iglesias",             "Real Betis",  "2020/21",    NA,  "9 M.",  57.4,  75L,
        "B. Iglesias",             "Real Betis",  "2019/20",    NA,  "6 M.",  32.8,  81L,
        "B. Iglesias",               "Espanyol",  "2019/20",    NA, "10 M.",  35.4,  82L,
        "B. Iglesias",               "Espanyol",  "2018/19",    NA,  "5 M.",  87.8,  83L,
        "B. Iglesias",          "Real Zaragoza",  "2017/18",    NA,  "1 M.",  70.3,  75L,
        "B. Iglesias",                "Celta B",  "2016/17",    NA,     "0",  26.3,  64L,
        "B. Iglesias",                  "Celta",  "2015/16",    NA,     "0",   3.9,  52L,
        "B. Iglesias",                "Celta B",  "2015/16",    NA,     "0",   9.1,  54L,
        "B. Iglesias",                  "Celta",  "2014/15",    NA,     "0",     1,  48L,
        "B. Iglesias",                "Celta B",  "2014/15",    NA,     "0",   9.4,  51L,
        "B. Iglesias",                "Celta B",  "2013/14",    NA,     "0",   9.2,  46L,
        "B. Iglesias",           "Villarreal C",  "2011/12",    NA,     "0",   3.6,  25L,
            "W. José",             "Real Betis",  "2021/22",    NA,  "7 M.",  46.5,  74L,
            "W. José",                 "Wolves",  "2020/21",    NA,  "3 M.",  20.2,  75L,
            "W. José",            "R. Sociedad",  "2019/20",    NA, "13 M.",  44.8,  78L,
            "W. José",            "R. Sociedad",  "2018/19",    NA, "15 M.",  69.8,  81L,
            "W. José",            "R. Sociedad",  "2017/18",    NA, "13 M.",    87,  83L,
            "W. José",            "R. Sociedad",  "2016/17",    NA, "10 M.",    66,  78L,
            "W. José",             "Las Palmas",  "2015/16",    NA,  "4 M.",  52.3,  74L,
            "W. José",          "Real Zaragoza",  "2014/15",    NA,  "3 M.",  35.1,  66L,
            "W. José",            "RM Castilla",  "2013/14",    NA,  "3 M.",  13.3,  64L,
            "W. José",              "Santos FC",  "2012/13",    NA,  "2 M.",  28.1,  65L,
            "W. José",              "São Paulo",  "2011/12",    NA,  "3 M.",  59.3,  60L,
            "W. José",              "São Paulo",  "2010/11",    NA,  "1 M.",    14,  52L,
            "W. José",         "Grêmio Barueri",  "2009/10",    NA,     "0",  27.1,  48L,
            "W. José",         "Grêmio Barueri",  "2008/09",    NA,     "0",   4.9,  31L,
             "Ruibal",             "Real Betis",  "2021/22",    NA,  "4 M.",  50.4,  70L,
             "Ruibal",             "Real Betis",  "2020/21",    NA,  "3 M.",  40.6,  68L,
             "Ruibal",                "Leganés",  "2019/20",    NA,  "1 M.",  44.6,  64L,
             "Ruibal",       "Rayo Majadahonda",  "2018/19",    NA,     "0",  59.7,  63L,
             "Ruibal",           "FC Cartagena",  "2017/18",    NA,     "0",   6.7,  54L,
             "Ruibal",        "Betis Deportivo",  "2016/17",    NA,     "0",  15.8,  46L,
             "Ruibal",        "Betis Deportivo",  "2015/16",    NA,     "0",   7.7,  44L,
             "Ruibal",               "Cornellà",  "2014/15",    NA,     "0",   0.5,  25L,
            "Joaquín",             "Real Betis",  "2021/22",    NA,     "0",  36.2,  67L,
            "Joaquín",             "Real Betis",  "2020/21",    NA,     "0",  35.9,  74L,
            "Joaquín",             "Real Betis",  "2019/20",    NA,     "0",  55.1,  79L,
            "Joaquín",             "Real Betis",  "2018/19",    NA,     "0",  87.3,  77L,
            "Joaquín",             "Real Betis",  "2017/18",    NA,  "1 M.",    34,  74L,
            "Joaquín",             "Real Betis",  "2016/17",    NA,  "3 M.",  24.9,  73L,
            "Joaquín",             "Real Betis",  "2015/16",    NA,  "3 M.",  25.4,  77L,
            "Joaquín",             "Fiorentina",  "2014/15",    NA,  "6 M.", 106.3,  78L,
            "Joaquín",             "Fiorentina",  "2013/14",    NA, "11 M.",  42.2,  77L,
            "Joaquín",                 "Málaga",  "2012/13",    NA, "10 M.", 123.3,  81L,
            "Joaquín",                 "Málaga",  "2011/12",    NA, "14 M.",  60.5,  78L,
            "Joaquín",               "Valencia",  "2010/11",    NA, "17 M.",  69.3,  80L,
            "Joaquín",               "Valencia",  "2009/10",    NA, "17 M.",  66.9,  80L,
            "Joaquín",               "Valencia",  "2008/09",    NA, "16 M.",    94,  81L,
            "Joaquín",               "Valencia",  "2007/08",    NA, "21 M.",  43.9,  79L,
            "Joaquín",               "Valencia",  "2006/07",    NA, "29 M.",  39.1,  82L,
            "Joaquín",             "Real Betis",  "2005/06",    NA, "30 M.", 108.2,  85L,
            "Joaquín",             "Real Betis",  "2004/05",    NA, "31 M.",  48.7,  86L,
            "Joaquín",             "Real Betis",  "2003/04",    NA, "30 M.",  62.7,  85L,
            "Joaquín",             "Real Betis",  "2002/03",    NA, "19 M.",    76,  82L,
            "Joaquín",             "Real Betis",  "2001/02",    NA,  "4 M.",  31.1,  74L,
            "Joaquín",             "Real Betis",  "2000/01",    NA,     "0",    23,  54L,
            "Joaquín",        "Betis Deportivo",  "1999/00",    NA,     "0",   4.4,  39L,
             "Juanmi",             "Real Betis",  "2021/22",    NA,  "3 M.",  85.5,  63L,
             "Juanmi",             "Real Betis",  "2020/21",    NA,  "5 M.",    48,  62L,
             "Juanmi",             "Real Betis",  "2019/20",    NA, "10 M.",  23.1,  72L,
             "Juanmi",            "R. Sociedad",  "2018/19",    NA, "10 M.",  79.6,  76L,
             "Juanmi",            "R. Sociedad",  "2017/18",    NA,  "8 M.",  70.4,  75L,
             "Juanmi",            "R. Sociedad",  "2016/17",    NA,  "4 M.",    57,  72L,
             "Juanmi",            "Southampton",  "2015/16",    NA,  "7 M.",  41.1,  68L,
             "Juanmi",                 "Málaga",  "2014/15",    NA,  "4 M.",  47.3,  70L,
             "Juanmi",                 "Málaga",  "2013/14",    NA,  "2 M.",  49.7,  57L,
             "Juanmi",                 "Racing",  "2012/13",    NA,     "0",   9.1,  52L,
             "Juanmi",                 "Málaga",  "2010/11",    NA,     "0",  12.5,  43L,
              "Tello",             "Real Betis",  "2021/22",    NA,  "4 M.",  47.8,  63L,
              "Tello",             "Real Betis",  "2020/21",    NA,  "5 M.",  37.4,  65L,
              "Tello",             "Real Betis",  "2019/20",    NA,  "8 M.",  30.9,  74L,
              "Tello",             "Real Betis",  "2018/19",    NA,  "8 M.",  87.1,  75L,
              "Tello",             "Real Betis",  "2017/18",    NA,  "8 M.",  74.2,  73L,
              "Tello",             "Fiorentina",  "2016/17",    NA,  "7 M.",  39.9,  74L,
              "Tello",             "Fiorentina",  "2015/16",    NA,  "1 M.",  26.4,  69L,
              "Tello",                  "Porto",  "2014/15",    NA,  "5 M.",  70.6,  71L,
              "Tello",              "Barcelona",  "2013/14",    NA,  "4 M.",  38.5,  63L,
              "Tello",              "Barcelona",  "2012/13",    NA,  "2 M.",  46.6,  62L,
              "Tello",              "Barcelona",  "2011/12",    NA,     "0",  31.3,  55L,
              "Tello",            "Barcelona B",  "2010/11",    NA,     "0",  10.5,  45L,
              "Tello",             "Espanyol B",  "2009/10",    NA,     "0",   7.9,  29L,
             "Lainez",             "Real Betis",  "2020/21",    NA,  "5 M.",  36.2,  58L,
             "Lainez",             "Real Betis",  "2019/20",    NA,  "5 M.",  31.6,  59L,
             "Lainez",             "Real Betis",  "2018/19",    NA,  "1 M.",    40,  63L,
             "Lainez",                "América",  "2017/18",    NA,     "0",  69.6,  46L,
             "Lainez",                "América",  "2016/17",    NA,     "0",  18.9,  41L
        )


df <- df %>% 
  mutate(valor = str_replace(valor, "M.", "")) %>% 
  mutate(valor = as.numeric(valor)) %>% 
  separate(temporada, c("temp_remove","temp"), sep = "/") %>% 
  mutate(temp = as.numeric(temp),
         jugador = as.factor(jugador),
         equipos = as.factor(equipos),
         elo = as.numeric(elo)) 


df %>% 
  ggplot(aes(x = temp, y = valor)) +
  geom_path(color = "black", linetype = 2) +
  facet_wrap(~ jugador, scales = "free") +
  scale_x_continuous(labels = scales::number_format(accuracy = 1)) +
  scale_y_continuous() +
  labs(title = "Evolución del valor de mercado de los jugadores del Real Betis durante su carrera",
       caption = "Source: Besoccer | @dataR_amateur") +
  ylab("Valor de mercado en millones de ???") +
  xlab("Temporada") +
  theme(text = element_text(size=12, family = "Bahnschrift", face = "bold"),
        plot.background = element_rect(fill = "#0BB363"),
        panel.background = element_rect(fill = "#0BB363"),
        strip.background = element_rect(fill = "white"),
        strip.text.x = element_text(color = "#0BB363", face = "bold.italic"),
        panel.grid = element_line(color = "white"),
        axis.text = element_text(color = "black", size = 9),
        plot.title = element_text(color = "black", size = 18, hjust = 0.5),
        plot.caption = element_text(color = "black", size = 8.5, hjust = 1),
        axis.title = element_text(color = "black"),
        legend.position = "none",
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank()) 


ggsave("vmercado.png", width = 12.5, height = 8, device = agg_png, dpi = 500)
